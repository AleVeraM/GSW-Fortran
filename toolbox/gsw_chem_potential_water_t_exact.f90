!==========================================================================
elemental function gsw_chem_potential_water_t_exact (sa, t, p)
!==========================================================================
!
!  Calculates the chemical potential of water in seawater.
!
!  SA  =  Absolute Salinity                                        [ g/kg ]
!  t   =  in-situ temperature (ITS-90)                            [ deg C ]
!  p   =  sea pressure                                             [ dbar ]
!         ( i.e. absolute pressure - 10.1325 dbar ) 
!
!  chem_potential_water_t_exact  =  chemical potential of water in seawater
!                                                                   [ J/g ]
!--------------------------------------------------------------------------

use gsw_mod_teos10_constants, only : gsw_sfac

implicit none
integer, parameter :: r14 = selected_real_kind(14,30)

real (r14), intent(in) :: sa, t, p

real (r14) :: gsw_chem_potential_water_t_exact

real (r14) :: g03_g, g08_g, g_sa_part, x, x2, y, z

real (r14), parameter :: kg2g = 1d-3

x2 = gsw_sfac*sa
x = sqrt(x2)
y = t*0.025d0
z = p*1d-4

g03_g = 101.342743139674d0 + z*(100015.695367145d0 + &
    z*(-2544.5765420363d0 + z*(284.517778446287d0 + &
    z*(-33.3146754253611d0 + (4.20263108803084d0 - 0.546428511471039d0*z)*z)))) + &
    y*(5.90578347909402d0 + z*(-270.983805184062d0 + &
    z*(776.153611613101d0 + z*(-196.51255088122d0 + (28.9796526294175d0 - 2.13290083518327d0*z)*z))) + &
    y*(-12357.785933039d0 + z*(1455.0364540468d0 + &
    z*(-756.558385769359d0 + z*(273.479662323528d0 + z*(-55.5604063817218d0 + 4.34420671917197d0*z)))) + &
    y*(736.741204151612d0 + z*(-672.50778314507d0 + &
    z*(499.360390819152d0 + z*(-239.545330654412d0 + (48.8012518593872d0 - 1.66307106208905d0*z)*z))) + &
    y*(-148.185936433658d0 + z*(397.968445406972d0 + &
    z*(-301.815380621876d0 + (152.196371733841d0 - 26.3748377232802d0*z)*z)) + &
    y*(58.0259125842571d0 + z*(-194.618310617595d0 + &
    z*(120.520654902025d0 + z*(-55.2723052340152d0 + 6.48190668077221d0*z))) + &
    y*(-18.9843846514172d0 + y*(3.05081646487967d0 - 9.63108119393062d0*z) + &
    z*(63.5113936641785d0 + z*(-22.2897317140459d0 + 8.17060541818112d0*z))))))))

g08_g = x2*(1416.27648484197d0 + &
    x*(-2432.14662381794d0 + x*(2025.80115603697d0 + &
    y*(543.835333000098d0 + y*(-68.5572509204491d0 + &
    y*(49.3667694856254d0 + y*(-17.1397577419788d0 + 2.49697009569508d0*y))) - 22.6683558512829d0*z) + &
    x*(-1091.66841042967d0 - 196.028306689776d0*y + &
    x*(374.60123787784d0 - 48.5891069025409d0*x + 36.7571622995805d0*y) + 36.0284195611086d0*z) + &
    z*(-54.7919133532887d0 + (-4.08193978912261d0 - 30.1755111971161d0*z)*z)) + &
    z*(199.459603073901d0 + z*(-52.2940909281335d0 + (68.0444942726459d0 - 3.41251932441282d0*z)*z)) + &
    y*(-493.407510141682d0 + z*(-175.292041186547d0 + (83.1923927801819d0 - 29.483064349429d0*z)*z) + &
    y*(-43.0664675978042d0 + z*(383.058066002476d0 + z*(-54.1917262517112d0 + 25.6398487389914d0*z)) + &
    y*(-10.0227370861875d0 - 460.319931801257d0*z + y*(0.875600661808945d0 + 234.565187611355d0*z))))) + &
    y*(168.072408311545d0))

g_sa_part = 8645.36753595126d0 + &
    x*(-7296.43987145382d0 + x*(8103.20462414788d0 + &
    y*(2175.341332000392d0 + y*(-274.2290036817964d0 + &
    y*(197.4670779425016d0 + y*(-68.5590309679152d0 + 9.98788038278032d0*y))) - 90.6734234051316d0*z) + &
    x*(-5458.34205214835d0 - 980.14153344888d0*y + &
    x*(2247.60742726704d0 - 340.1237483177863d0*x + 220.542973797483d0*y) + 180.142097805543d0*z) + &
    z*(-219.1676534131548d0 + (-16.32775915649044d0 - 120.7020447884644d0*z)*z)) + &
    z*(598.378809221703d0 + z*(-156.8822727844005d0 + (204.1334828179377d0 - 10.23755797323846d0*z)*z)) + &
    y*(-1480.222530425046d0 + z*(-525.876123559641d0 + (249.57717834054571d0 - 88.449193048287d0*z)*z) + &
    y*(-129.1994027934126d0 + z*(1149.174198007428d0 + z*(-162.5751787551336d0 + 76.9195462169742d0*z)) + &
    y*(-30.0682112585625d0 - 1380.9597954037708d0*z + y*(2.626801985426835d0 + 703.695562834065d0*z))))) + &
    y*(1187.3715515697959d0)

gsw_chem_potential_water_t_exact = kg2g*(g03_g + g08_g - .5d0*x2*g_sa_part)

return
end function

!--------------------------------------------------------------------------
