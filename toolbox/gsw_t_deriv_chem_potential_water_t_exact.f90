!==========================================================================
elemental function gsw_t_deriv_chem_potential_water_t_exact (sa, t, p)
!==========================================================================
!
!  Calculates the temperature derivative of the chemical potential of water
!  in seawater so that it is valid at exactly SA = 0.
!
!  SA  =  Absolute Salinity                                        [ g/kg ]
!  t   =  in-situ temperature (ITS-90)                            [ deg C ]
!  p   =  sea pressure                                             [ dbar ]
!         ( i.e. absolute pressure - 10.1325 dbar ) 
!
!  chem_potential_water_dt  =  temperature derivative of the chemical 
!                           potential of water in seawater  [ J g^-1 K^-1 ]
!--------------------------------------------------------------------------

use gsw_mod_teos10_constants, only : gsw_sfac, rec_db2pa

implicit none
integer, parameter :: r14 = selected_real_kind(14,30)

real (r14), intent(in) :: sa, t, p

real (r14) :: gsw_t_deriv_chem_potential_water_t_exact

real (r14) :: g03_t, g08_sa_t, x, x2, y, z, g08_t

real (r14), parameter :: kg2g = 1d-3

! Note. The kg2g, a factor of 1e-3, is needed to convert the output of this
! function into units of J/g. See section (2.9) of the TEOS-10 Manual.

x2 = gsw_sfac*sa
x = sqrt(x2)
y = t*0.025d0
z = p*rec_db2pa ! the input pressure (p) is sea pressure in units of dbar.

g03_t = 5.90578347909402d0 + z*(-270.983805184062d0 + &
        z*(776.153611613101d0 + z*(-196.51255088122d0 + (28.9796526294175d0 - &
	2.13290083518327d0*z)*z))) + &
        y*(-24715.571866078d0 + z*(2910.0729080936d0 + &
        z*(-1513.116771538718d0 + z*(546.959324647056d0 + &
	z*(-111.1208127634436d0 + 8.68841343834394d0*z)))) + &
        y*(2210.2236124548363d0 + z*(-2017.52334943521d0 + &
        z*(1498.081172457456d0 + z*(-718.6359919632359d0 + &
	(146.4037555781616d0 - 4.9892131862671505d0*z)*z))) + &
        y*(-592.743745734632d0 + z*(1591.873781627888d0 + &
        z*(-1207.261522487504d0 + (608.785486935364d0 - &
	105.4993508931208d0*z)*z)) + &
        y*(290.12956292128547d0 + z*(-973.091553087975d0 + &
        z*(602.603274510125d0 + z*(-276.361526170076d0 + &
	32.40953340386105d0*z))) + &
        y*(-113.90630790850321d0 + y*(21.35571525415769d0 - &
	67.41756835751434d0*z) + &
        z*(381.06836198507096d0 + z*(-133.7383902842754d0 + &
	49.023632509086724d0*z)))))))
    
g08_t = x2*(168.072408311545d0 + &
        x*(-493.407510141682d0 + x*(543.835333000098d0 + &
	x*(-196.028306689776d0 + 36.7571622995805d0*x) + &
        y*(-137.1145018408982d0 + y*(148.10030845687618d0 + &
	y*(-68.5590309679152d0 + 12.4848504784754d0*y))) - &
        22.6683558512829d0*z) + z*(-175.292041186547d0 + &
	(83.1923927801819d0 - 29.483064349429d0*z)*z) + &
        y*(-86.1329351956084d0 + z*(766.116132004952d0 + &
	z*(-108.3834525034224d0 + 51.2796974779828d0*z)) + &
        y*(-30.0682112585625d0 - 1380.9597954037708d0*z + &
	y*(3.50240264723578d0 + 938.26075044542d0*z)))))
    
g08_sa_t = 1187.3715515697959d0 + &
        x*(-1480.222530425046d0 + x*(2175.341332000392d0 + &
	x*(-980.14153344888d0 + 220.542973797483d0*x) + &
        y*(-548.4580073635929d0 + y*(592.4012338275047d0 + &
	y*(-274.2361238716608d0 + 49.9394019139016d0*y))) - &
        90.6734234051316d0*z) + z*(-525.876123559641d0 + &
	(249.57717834054571d0 - 88.449193048287d0*z)*z) + &
        y*(-258.3988055868252d0 + z*(2298.348396014856d0 + &
	z*(-325.1503575102672d0 + 153.8390924339484d0*z)) + &
        y*(-90.2046337756875d0 - 4142.8793862113125d0*z + &
	y*(10.50720794170734d0 + 2814.78225133626d0*z))))
    
gsw_t_deriv_chem_potential_water_t_exact = kg2g*((g03_t + g08_t)*0.025d0 - &
                                           0.5d0*gsw_sfac*0.025d0*sa*g08_sa_t)
return
end function

!--------------------------------------------------------------------------
